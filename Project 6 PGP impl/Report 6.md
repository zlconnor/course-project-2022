# 山东大学网络空间安全学院

# 网络空间安全创新创业实践

<img src="F:\typora_img\sdu.webp" alt="sdu" style="zoom: 25%;" />







# Project 4 PGP

# 姓名：张麟康          

# 学号：201900301107





















## 原理分析

![image-20220720104920976](F:\typora_img\image-20220720104920976.png)

### 加密

* 使用密码杂凑函数**==MD5==**对消息$M$进行摘要处理得到$H(M)$
* 对消息摘要进行签名得到$\sigma(H(M))$
* 将摘要签名和消息级联作为发送的消息$\sigma(H(M))||M$
* 对发送的消息进行压缩记作$Z(\sigma(H(M))||M)$
* 对压缩消息用会话密钥$K_s$利用对称加密算法**==IDEA==**进行加密得到$EC_{K_s}(Z(\sigma(H(M))||M))$
* 将该会话密钥用公钥$KU_b$使用**==SM2==**加密算法进行加密得到$EP_{KU_b}(K_s)$
* 将加密后的会话密钥与加密后的压缩消息级联发送给接收方记作$EP_{KU_b}(K_s)||EC_{K_s}(Z(\sigma(H(M))||M))$

### 解密

* 从接收到的消息中提取出$EP_{KU_b}(K_s)$和$EC_{K_s}(Z(\sigma(H(M))||M))$
* 用公钥对应的私钥$KU_a$对$EP_{KU_b}(K_s)$进行**==SM2==**解密算法解密得到会话密钥$K_s$
* 利用会话密钥对$EC_{K_s}(Z(\sigma(H(M))||M))$利用==**IDEA**==进行解密得到压缩后的签名消息对$Z(\sigma(H(M))||M)$
* 对压缩的消息进行解压缩得到$\sigma(H(M))||M$
* 分离出签名$\sigma(H(M))$和消息$M$
* 对解密后的邮件数据进行**==MD5==**压缩，验证生成的数字签名与解密所得签名是否相同

## 具体实现

